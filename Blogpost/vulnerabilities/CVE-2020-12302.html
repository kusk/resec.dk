<!DOCTYPE html>

<html lang="en">

        <head>
                <!-- Page information -->
                <meta charset="UTF-8" />
                <meta name="node_id" content="cve-2020-12302">
                <meta name="viewport" content="width=device-width, initial-scale=1.0" />
                <link rel="shortcut icon" href="/favicon.ico" />

                <!-- Set title -->
                <title>resec.dk</title>

                <!-- Includes -->
                <script src="/obs.html/static/obsidian_core.js"></script>
<script src="/obs.html/static/encoding.js"></script>
<link rel="stylesheet" href="/obs.html/static/master.css" />
<script src="https://unpkg.com/smiles-drawer@2.0.3/dist/smiles-drawer.min.js"></script><script src="/obs.html/static/smiles.js"></script>
<script type="module">
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
    mermaid.initialize({
            'securityLevel': 'loose',
            'theme': 'dark',
            'themeVariables': {
                    'darkMode': true,
            }
    });
</script>
<script>
  MathJax = {
    loader: {
      load: [
        '[tex]/action',
        'output/chtml',
        '[tex]/centernot'
      ]
    },
    tex: {
      inlineMath: [ ["\\(","\\)"] ],
      displayMath: [ ["\\[","\\]"] ],
      processEscapes: true,
      processEnvironments: true,
      packages: {'[+]': ['centernot']}
    }
  };
</script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
<script src="/obs.html/static/dirtree.js"></script>
<link rel="stylesheet" href="/custom.css" />



                <!-- Onload tweaks -->
                <script>
                        const CURRENT_NODE = 'cve-2020-12302';
                        const PAGE_DEPTH = 2;
                </script>
        </head>

<body class="theme-obs-light">
        <div id="antiflash" style="display: none;"></div>
        <script>
                document.getElementById('antiflash').style.display = 'block';
        </script>
        
        <div id="page_holder" class="flex_col">
                <div id="header" class="header" style="position:fixed">
                        <div id="header_flex" class="flex_row">
                                <a href="/index.html" id="homelink" title="Clear screen and go to homepage">resec.dk</a>
                                <div class="navbar-button" onclick="toggle_menu()">
                                        ≡
                                </div>
                                <div id="navbar" class="navbar">
                                        
                                        <a href="/">resec.dk</a>
                                        <div class="icon-tray">
                                                
                                                
                                                
                                        
                                                
                                                
                                        </div>
                                </div>
                        </div>
                        
                </div>
                <div id="header2" class="header">
                        <div id="header_flex2" class="flex_row">
                                <a href="/index.html" id="homelink" title="Clear screen and go to homepage">/resec.dk</a>
                                <div class="navbar-button" onclick="toggle_menu()">
                                        ≡
                                </div>
                                <div id="navbar2" class="navbar">
                                        
                                        <div class="icon-tray">
                                                
                                                
                                                
                                                        <div >
            <a id="dirtree_link" class="system-link" href="/obs.html/dir_index.html" title="View directory tree">
                    <img src = "/obs.html/static/dirtree.svg" style="width: 12px; padding: 4px;" alt="Directory tree link"/>
            </a>
        </div>
                                                
                                                
                                        </div>
                                </div>
                        </div>
                        
                </div>
                <div class="flex_row" id="container_row">
                        <div class="container-wrapper ">
                                <div class="container">
                                <div class="content"><h1 id="intel-driver-support-assistant-privilege-escalation">Intel Driver &amp; Support Assistant - Privilege Escalation</h1>
<p>Also published here: <a href="https://blog.improsec.com/tech-blog/unpatched-privilege-escalation-vulnerability-in-intel-driver-amp-support-assistant" class="external-link">Unpatched privilege escalation vulnerability in Intel Driver &amp; Support Assistant. — Improsec | improving security</a>   </p>
<p>This blog post highlights a trivial privilege escalation vulnerability in Intel Driver &amp; Support Assistant. Intel Driver &amp; Support Assistant is an application for keeping drivers, firmware and software packages up-to-date on systems using Intel hardware.   </p>
<p>When we first contacted Intel we were informed, that another researcher already had reported the same vulnerability. We were furthermore informed, that the vulnerability would be fixed in 60 days or sooner. Improsec’s <a href="https://improsec.com/en/responsible-disclosure" class="external-link">Responsible Disclosure policy</a> dictates a 90 day period for the security measures to be designed, developed, tested and implemented with customers before we publish information about the vulnerability, and that time has passed now.   </p>
<p>During the 60 days several new versions of the application were released, from 20.5.20 to 20.8.30.6.   </p>
<p>However the vulnerability is still present in the newest version.   </p>
<h2 id="cve-registered">CVE registered</h2>
<p>CVE-2020-12302   </p>
<h2 id="affected-versions">Affected versions</h2>
<p>20.5.20 at the time of discovery. <br />
20.8.30.6 at the time of public disclosure.   </p>
<h2 id="timeline">Timeline</h2>
<ul>
<li>22/05/20 - Intel Product Security Incident Response Team is e-mailed with detailed description   </li>
<li>22/05/20 - Intel Product Security Incident Response Team informs that they are investigating the issue.   </li>
<li>08/06/20 - Intel Product Security Incident Response Team confirms the vulnerability and informs us that the vulnerability has been reported previously. The vulnerability is currently being mitigated.   </li>
<li>10/06/20 - Intel Product Security Incident Response Team informs that a patch should be available within 60 days. CVE-2020-12302 has been allocated for the vulnerability.   </li>
<li>26/08/20 – Vulnerability is disclosed without a patch.   </li>
</ul>
<h2 id="productpage">Productpage</h2>
<ul>
<li><a href="http://www.intel.com/content/www/us/en/support/detect.html" class="external-link">http://www.intel.com/content/www/us/en/support/detect.html</a>   </li>
<li><a href="https://www.intel.com/content/www/us/en/support/intel-driver-support-assistant.html" class="external-link">https://www.intel.com/content/www/us/en/support/intel-driver-support-assistant.html</a>   </li>
</ul>
<h2 id="changelog">Changelog</h2>
<ul>
<li><a href="https://www.intel.com/content/www/us/en/support/topics/idsa-faq.html" class="external-link">https://www.intel.com/content/www/us/en/support/topics/idsa-faq.html</a>   </li>
</ul>
<h2 id="walkthrough">Walkthrough</h2>
<p>Viewing the management rights for the service “Intel® SUR QC SAM” for “Everyone” on a default installation, showed that all users had the rights to start the service executable. By default, the service executable is set to “Manual” start-up type. <br />
<img alt="" src="/Blogpost/vulnerabilities/Attachments/767ce544a153311342022ffe49d46ede_MD5.png" />   </p>
<p>Starting the service with Windows built-in command line service program ”sc”. <br />
<img alt="" src="/Blogpost/vulnerabilities/Attachments/439d02e466876763af86d4bd7645df21_MD5.png" />   </p>
<p>During the start-up process the service executable tries to load a DLL called “python3.dll”, first from the root of the “C:\”-drive and then from the “C:\DLLs\” directory. Both fails as the file is non-existing. The executables automatically closes when it’s done processing (about 1-5 seconds after start). <br />
<img alt="" src="/Blogpost/vulnerabilities/Attachments/380e3419041a8eb01a64eb0da8b5eae6_MD5.png" />   </p>
<p>The problem is likely caused by the file “pyconfig.h” in “C:\Program Files\Intel\SUR\QUEENCREEK\Updater\bin\Include\” directory that defines search paths for the “python3.dll” file. <br />
<img alt="" src="/Blogpost/vulnerabilities/Attachments/775f4111003e72ce7b3d3681f53bbf7e_MD5.png" />   </p>
<p>As even low privileged users by default has the rights to create directories in the root of “C:\”, any user can create the missing “DLLs” directory and place a malicious DLL-file called “python3.dll” in the directory.     </p>
<p>Starting the services executable again will load the malicious DLL-file and execute our payload. <br />
<img alt="" src="/Blogpost/vulnerabilities/Attachments/004797260593c41fc85ad2ba5417806c_MD5.png" />   </p>
<p>Sample code for payload DLL-file. <br />
<img alt="" src="/Blogpost/vulnerabilities/Attachments/9f66f0542d8f2c5566ed917960884052_MD5.png" /></p></div>
<div class="note-footer">
<div class="tags">

</div>

</div>

                                <!-- end content -->
                                </div>
                        </div>
                </div>
        </div>

        <script src="/obs.html/static/obsidian_tabs_footer.js" type="text/javascript"></script>

        

</body>
</html>
